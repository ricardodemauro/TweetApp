(this["webpackJsonptweet-app"]=this["webpackJsonptweet-app"]||[]).push([[0],{112:function(e,t,a){e.exports=a(289)},117:function(e,t,a){},289:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(103),o=a.n(c),i=(a(117),a(16)),l=a(4),s=a(6);var u=function(){return r.a.createElement("header",{className:"masthead mb-auto"},r.a.createElement("div",{className:"inner"},r.a.createElement("h3",{className:"masthead-brand"},"Cover"),r.a.createElement("nav",{className:"nav nav-masthead justify-content-center"},r.a.createElement(i.NavLink,{className:"nav-link",to:"/",exact:!0},"Home"),r.a.createElement(i.NavLink,{className:"nav-link",to:"/app"},"Tweets"),r.a.createElement(i.NavLink,{className:"nav-link",to:"/profile"},"Profile"),r.a.createElement(i.NavLink,{className:"nav-link",to:"/logout"},"LogOut"))))},m=function(){return r.a.createElement("footer",{className:"mastfoot mt-auto"},r.a.createElement("div",{className:"inner"},r.a.createElement("p",null,"POC made over twitch streams on ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://rmauro.dev/twitch"},"RMauro's Twitch"),". Source code on ",r.a.createElement("a",{href:"https://github.com/ricardodemauro/TweetApp"},"Github"),".")))},p=a(5),d=a.n(p),h=a(14),f=a(15),b=a(43),v=a(105),w=function(){return r.a.createElement(v.DisappearedLoading,null)},E=function(){var e=Object(s.useOktaAuth)(),t=e.authState,a=e.authService,c=Object(n.useState)(null),o=Object(f.a)(c,2),i=o[0],l=o[1],u=Object(n.useState)(!1),m=Object(f.a)(u,2),p=m[0],v=m[1];Object(n.useEffect)((function(){var e=function(){var e=Object(h.a)(d.a.mark((function e(){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isAuthenticated){e.next=5;break}l(null),v(!0),e.next=10;break;case 5:return e.next=7,a.getUser();case 7:n=e.sent,l(n),v(!0);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(h.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()}),[t,a]);var E=function(){var e=Object(h.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isAuthenticated){e.next=4;break}console.log("you`re already logged in. Do nothing"),e.next=6;break;case 4:return e.next=6,a.login("/");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("main",{role:"main",className:"inner cover"},r.a.createElement("div",{className:"lead"},!p&&r.a.createElement(w,null),p&&i&&r.a.createElement("p",null,"Welcome back, ",i.name,"!"),p&&!i&&r.a.createElement(b.a,{onClick:E,className:"btn btn-lg btn-secondary"},"Login with OKTA")))},g=a(109),k=function(e){var t=e.name;return r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 50 50",width:"36",height:"36"},r.a.createElement("circle",{cx:"25",cy:"25",r:"20",stroke:"black",strokeWidth:"1",fill:"#343a40"}),r.a.createElement("text",{x:"13.5",y:"30",className:"textSvg",fill:"white"},t?t.substring(0,2).toUpperCase():"??"))},N=function(e){return r.a.createElement("span",null,"@".concat(e.name))},x=function(e){return r.a.createElement("span",{className:"text-dark"},e.tweet)},y=function(e){var t=e.image,a=e.name,n=(e.handle,e.tweet);return r.a.createElement(r.a.Fragment,null,r.a.createElement(k,{name:a,image:t}),r.a.createElement("div",{className:"media-body px-2 text-justify"},r.a.createElement("h6",{className:"mt-0 d-block text-dark"},r.a.createElement(N,{name:a})),r.a.createElement(x,{tweet:n})))},O=function(e){var t=e.onFormSubmit,a=Object(n.useState)(""),c=Object(f.a)(a,2),o=c[0],i=c[1];return r.a.createElement("div",{className:"text-white-50 rounded shadow-sm my-3 bg-purple"},r.a.createElement("div",{className:"row p-3"},r.a.createElement("form",{className:"w-100 col-12",onSubmit:function(e){e.preventDefault(),t&&t({tweet:o}),i("")}.bind(void 0)},r.a.createElement("p",{className:"h4 mb-4"},"Submit your tweet"),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",className:"form-control",value:o,onChange:function(e){return i(e.target.value)},"aria-describedby":"tweet",placeholder:"your tweet"})),r.a.createElement("div",{className:"row lh-100"},r.a.createElement("div",{className:"col-12"},r.a.createElement("button",{type:"submit",className:"btn btn-primary",style:{position:"absolute",right:"15px"}},"Submit"),r.a.createElement("h6",{className:"mb-0 text-white lh-100"},"Bootstrap"),r.a.createElement("small",null,"Since 2011"))))))},j="https://".concat("okta.rmaurolabs.dev","/oauth2/default"),S=window.location.host,A="http://".concat(S).concat("/implicit/callback"),T="https://".concat(S).concat("/implicit/callback"),C={issuer:j,clientId:"0oa4gpq1oyOsCygrt357",redirectUri:window.location.href.indexOf("github.io")>-1?"https://ricardodemauro.github.io/TweetApp".concat("/implicit/callback"):window.location.protocol.indexOf("https")>-1?T:A,scope:"openid profile email".split(/\s+/)},L=function(){return window.location.href.indexOf("localhost")>-1?"http://localhost:7071/api/Tweet/":"https://tweetappapi0033.azurewebsites.net/api/tweet/"};var W=function(){var e=Object(s.useOktaAuth)(),t=e.authState,a=e.authService,c=Object(n.useState)(0),o=Object(f.a)(c,2),i=o[0],l=void 0===i?[]:i,u=o[1],m=Object(n.useState)(!1),p=Object(f.a)(m,2),b=p[0],v=p[1];function E(){return k.apply(this,arguments)}function k(){return(k=Object(h.a)(d.a.mark((function e(){var a,n,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(!1),e.next=3,fetch(L(),{method:"get",headers:{Authorization:"Bearer ".concat(t.accessToken),"Content-Type":"application/json"}});case 3:return a=e.sent,e.next=6,a.json();case 6:n=e.sent,r=n.map((function(e,t){return{name:e.user,tweet:e.message}})),u(r),v(!0);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return(N=Object(h.a)(d.a.mark((function e(a){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(L(),{method:"POST",body:JSON.stringify({message:a.tweet}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.accessToken)}});case 2:if(!(n=e.sent).ok){e.next=8;break}return e.next=6,n.json();case 6:return e.next=8,E();case 8:console.warn("something bad happened",n.statusText);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){Object(h.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()}),[t,a]),r.a.createElement("main",{role:"main",className:"h-auto"},r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"container my-3 p-3 bg-dark rounded shadow-sm"},r.a.createElement("h1",null,"Mini Tweet"),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement(O,{onFormSubmit:function(e){return N.apply(this,arguments)}.bind(this)}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12"},r.a.createElement("h6",{className:"border-bottom border-gray pb-2 mb-0"},"Recent updates"),!b&&r.a.createElement("div",{className:"col-12 mt-4"},r.a.createElement(w,null)),b&&r.a.createElement("ul",{className:"list-unstyled"},Array.isArray(l)&&Object(g.a)(l).map((function(e,t){return r.a.createElement("li",{className:"media shadow p-1 mb-2 bg-white rounded",key:t},r.a.createElement(y,e))}))))))))},R=function(){var e=Object(s.useOktaAuth)(),t=e.authState,a=e.authService;return t.isPending?r.a.createElement("div",null,"Loading authentication..."):t.isAuthenticated?r.a.createElement("h1",{className:"bg-white"},"Something"):r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-primary",onClick:function(){return a.login("/profile")}},"Login"))},B=function(){var e=Object(s.useOktaAuth)(),t=e.authState,a=e.authService,c=Object(n.useState)(null),o=Object(f.a)(c,2),i=o[0],l=o[1];return Object(n.useEffect)((function(){t.isAuthenticated?a.getUser().then((function(e){l(e)})):l(null)}),[t,a]),r.a.createElement("main",{role:"main",className:"h-100"},r.a.createElement("div",null,i&&r.a.createElement("div",null,r.a.createElement("p",null,"Welcome back, ",i.name,"!"),r.a.createElement("p",{style:{wordBreak:"break-all"}},"Access Token, ",t.accessToken))))},U="".concat(window.location.origin,"/logout"),P=Object(l.o)((function(e){var t=e.history,a=Object(s.useOktaAuth)(),c=a.authState,o=a.authService;Object(n.useEffect)((function(){c.isAuthenticated&&Object(h.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()}),[c,o]),c.isAuthenticated||t.push("/");var i=function(){var e=Object(h.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.idToken,e.next=3,o.logout("/");case 3:window.location.href="".concat(j,"/v1/logout?id_token_hint=").concat(t,"&post_logout_redirect_uri=").concat(U);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("main",{role:"main",className:"inner cover"},r.a.createElement("div",{className:"lead"},r.a.createElement(b.a,{onClick:i,className:"btn btn-lg btn-secondary"},"Logout")))}));function _(){return r.a.createElement("div",{className:"text-center",style:{height:"100%"}},r.a.createElement("div",{className:"container d-flex h-100 p-3 mx-auto flex-column"},r.a.createElement(i.BrowserRouter,null,r.a.createElement(u,null),r.a.createElement(s.Security,C,r.a.createElement(l.d,{path:"/",exact:!0,component:E}),r.a.createElement(s.SecureRoute,{path:"/app",component:W}),r.a.createElement(s.SecureRoute,{path:"/auth",component:R}),r.a.createElement(s.SecureRoute,{path:"/profile",component:B}),r.a.createElement(l.d,{path:"/implicit/callback",component:s.LoginCallback}),r.a.createElement(l.d,{path:"/logout",component:P})),r.a.createElement(m,null))))}var z=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function D(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(_,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");z?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):D(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):D(t,e)}))}}()}},[[112,1,2]]]);
//# sourceMappingURL=main.5764338b.chunk.js.map